# 6. Binary Tree Maximum Path Sum

## 題目
給定二元樹,找出任意節點到任意節點的路徑中,節點值總和的最大值。
路徑定義:從任一節點出發,沿父子關係到達另一節點的路徑,每個節點最多經過一次。

## 面試重點
此題測試**後序遍歷與全域最優解的維護**,核心難點是區分「路徑和」與「可向上貢獻的和」。

核心思路:
- 遞迴函數回傳:經過當前節點向上延伸的最大單邊和
- 內部計算:經過當前節點的完整路徑最大和(可能包含左右子樹)
- 更新全域最大值:max_sum = max(max_sum, node.val + left_gain + right_gain)
- 回傳給父節點:node.val + max(left_gain, right_gain, 0)

關鍵洞察:
1. 每個節點可以選擇:只取自己、取自己+左子樹、取自己+右子樹
2. 路徑不能分叉(不能同時向左右延伸後再向上)
3. 負數子樹直接捨棄(max with 0)

面試官會重點觀察:
- 能否區分「內部最大路徑和」與「向上貢獻的和」
- 為何不能直接回傳最大路徑和:會導致分叉路徑
- 後序遍歷的必要性:需要先知道子樹資訊
- 全域變數的使用:因為遞迴回傳值有特殊意義
- 負數處理:max(gain, 0)的作用

**常考公司**:
- Google(高頻樹題)
- Facebook/Meta(樹的變形題常客)
- Microsoft、Apple
- 難度較高,展現遞迴理解深度

此題展現了**遞迴回傳值設計的精妙之處**,是樹問題的高階技巧。

## 複雜度
- 時間複雜度:O(n)
- 空間複雜度:O(h),遞迴堆疊深度

## Follow-up
- 若要輸出最大路徑本身(節點序列),該如何修改?
- 若限制路徑必須從根節點出發,演算法如何簡化?
- 若是 N 叉樹,演算法如何調整?
- 若允許經過節點多次,問題會變成什麼?