# 16. Design In-Memory File System

## 題目
設計記憶體檔案系統,支援以下操作:
- ls(path):列出路徑下的檔案/目錄,按字典序回傳
- mkdir(path):創建目錄(含父目錄)
- addContentToFile(filePath, content):在檔案末尾添加內容,檔案不存在則創建
- readContentFromFile(filePath):讀取檔案內容

## 面試重點
此題測試**Trie 的變形應用 + 檔案系統設計**,展現物件導向與資料結構的結合。

核心設計:
1. **Node 類別**:
   - isFile:區分檔案與目錄
   - children:子目錄/檔案的 HashMap
   - content:若為檔案則儲存內容
2. **路徑解析**:
   - split('/') 獲取各層級
   - 遍歷 Trie 找到對應節點
3. **mkdir**:
   - 逐層創建不存在的目錄節點
4. **ls**:
   - 若為檔案,回傳檔案名
   - 若為目錄,回傳所有子項並排序

面試官會重點觀察:
- Node 設計:如何區分檔案與目錄
- 路徑解析:處理 "/", "//", 結尾斜線
- Trie 遍歷:找到或創建路徑
- 排序要求:ls 回傳字典序
- 邊界處理:根目錄、不存在的路徑
- 並發安全性考慮(進階)

**常考公司**:
- Dropbox、Google Drive(雲端儲存)
- Amazon S3 相關
- 檔案系統公司
- 系統設計常見題

此題展現了**如何用 Trie 建模階層結構**,類似URL路由、DNS等場景。

## 複雜度
- ls:O(m + k log k),m 為路徑長度,k 為目錄項數
- mkdir:O(m)
- addContentToFile:O(m + n),n 為內容長度
- readContentFromFile:O(m + n)
- 空間複雜度:O(N),N 為所有路徑總長度

## Follow-up
- 若要支援檔案刪除,如何實作?
- 若要支援軟連結(symbolic link),資料結構如何調整?
- 若要支援檔案權限,如何設計?
- 分散式環境下,如何實現?