# 2. Longest Valid Parentheses

## 題目
給定只包含 '(' 和 ')' 的字串,找出最長有效(格式正確且連續)括號子字串的長度。

## 面試重點
此題測試**Stack 與 DP 的多種解法**,展現同一問題的不同思維角度。

**方法一:動態規劃**
- 狀態定義:dp[i] = 以 i 結尾的最長有效括號長度
- 狀態轉移:
  - s[i] == '(':dp[i] = 0(不可能以左括號結尾)
  - s[i] == ')':
    - 若 s[i-1] == '(':dp[i] = dp[i-2] + 2
    - 若 s[i-1] == ')' 且 s[i-dp[i-1]-1] == '(':
      dp[i] = dp[i-1] + 2 + dp[i-dp[i-1]-2]

**方法二:Stack**
- 維護左括號的索引
- 遇到右括號時配對,計算長度
- 用 -1 作為基準索引

**方法三:雙向掃描**
- 從左到右:記錄左右括號數,相等時更新最大值,右>左時重置
- 從右到左:記錄左右括號數,相等時更新最大值,左>右時重置
- 處理只有左括號過多或右括號過多的情況

面試官會重點觀察:
- 能否實作至少兩種方法
- DP 方法中複雜轉移方程的理解
- Stack 方法中基準索引的巧妙運用
- 雙向掃描方法的簡潔性與正確性證明
- 各方法的時間空間權衡

**常考公司**:
- Google(考察多種解法能力)
- Facebook/Meta(括號相關變形題常客)
- Amazon(編碼面試高頻)

此題展現了**一題多解的思維廣度**,是展現演算法功底的好題。

## 複雜度
**DP 方法**:
- 時間複雜度:O(n)
- 空間複雜度:O(n)

**Stack 方法**:
- 時間複雜度:O(n)
- 空間複雜度:O(n)

**雙向掃描**:
- 時間複雜度:O(n)
- 空間複雜度:O(1)

## Follow-up
- 若要找出所有最長有效括號子字串的起始位置,如何修改?
- 若括號類型增加(如 []、{}),演算法如何調整?
- 若要求不連續的最長有效括號,該用什麼方法?